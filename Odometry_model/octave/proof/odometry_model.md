# Odometry Model

狀態向量：

```
[x, y, θ]^T  ->  [x̄', ȳ', θ̄']^T
```

---

## 定義

```
δ_trans = sqrt((x̄' - x̄)^2 + (ȳ' - ȳ)^2)
```

```
δ_rot1 = atan2(ȳ' - ȳ, x̄' - x̄) - θ̄
```

```
δ_rot2 = θ̄' - θ̄ - δ_rot1
```

---

## 問題設定

給定：

```
[δ_rot1, δ_trans, δ_rot2]^T
```

計算：

```
[x̄', ȳ', θ̄']^T
```

初始姿態：

```
[x̄, ȳ, θ̄]^T = [0, 0, 0]^T
```

---

## 角度關係

```
θ̄' = δ_rot2 + θ̄ + δ_rot1
```

---

## 幾何推導

定義：

```
A = x̄' - x̄
B = ȳ' - ȳ
```

距離關係：

```
δ_trans^2 = A^2 + B^2
```

角度關係：

```
tan(δ_rot1 + θ̄) = B / A
```

---

### 解出 A, B

```
B = A * tan(δ_rot1 + θ̄)
```

```
δ_trans^2 = A^2 (1 + tan^2(δ_rot1 + θ̄))
          = A^2 sec^2(δ_rot1 + θ̄)
```

```
A^2 = δ_trans^2 cos^2(δ_rot1 + θ̄)
```

```
A = δ_trans cos(δ_rot1 + θ̄)
B = δ_trans sin(δ_rot1 + θ̄)
```

---

## 最終更新方程式

```
x̄' = x̄ + δ_trans cos(δ_rot1 + θ̄)
ȳ' = ȳ + δ_trans sin(δ_rot1 + θ̄)
```
